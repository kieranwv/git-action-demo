
# 🧯 生产事故报告

## 一、事故概要

- **标题**：`[High] 表单提交失败导致用户数据丢失`
- **严重等级**：High / Medium / Low
- **影响范围**：业务系统 / 用户群体 / 服务模块
- **发生时间**：2025-07-15 14:33（UTC+8）
- **发现方式**：用户反馈 / 自动监控 / QA 测试 / 开发自查

---

## 二、问题描述

简要描述问题现象，发生场景和影响，例如：

> 用户在提交表单时出现 `500` 错误，导致数据未写入数据库，影响了当日所有报名用户的信息保存。

---

## 三、事故原因分析

- **根因分析（Root Cause）**：
  - 原因 1：后端接口参数校验逻辑缺失
  - 原因 2：部署前未覆盖该逻辑的集成测试
  - 原因 3：开发未明确告知字段新增对旧客户端的影响

> 建议使用“5 Whys”方法逐层递进分析：

```
Q: 为什么表单提交失败？
A: 请求参数缺失

Q: 为什么缺失？
A: 前端未传 required 字段

Q: 为什么前端未传？
A: 开发对字段变更未同步

Q: 为什么未同步？
A: 缺少接口字段变更通知机制

Q: 为什么机制缺失？
A: 没有强制 API 文档变更流程
```

---

## 四、应急响应与处置流程

- [x] 第一时间通知测试/后端负责人
- [x] 紧急关闭表单入口，防止更多用户受影响
- [x] 创建 `hotfix-xxx` 分支，进行修复
- [x] 修复后部署测试环境验证
- [x] 合并到 `master`，打 tag 部署生产
- [x] 回滚受影响数据 & 补偿用户通知

---

## 五、修复过程

| 步骤 | 描述 |
|------|------|
| 创建分支 | `hotfix-2315-form-submit` |
| 修复内容 | 增加参数校验，兼容旧接口 |
| 测试 | 本地、测试环境验证通过 |
| 合并 | 提交 MR → merge 到 `master` 分支 |
| 部署 | 生成 tag `v1.2.5` 并部署上线 |
| 同步开发 | `dev` 分支已 rebase 最新 `master` |

---

## 六、修复效果评估

- [x] 表单已可正常提交
- [x] 日志未再出现异常报错
- [x] 补偿用户反馈已完成
- [ ] 无新增问题

---

## 七、事后改进措施

| 措施 | 描述 |
|------|------|
| ✅ 引入参数校验中间件 | 降低遗漏风险 |
| ✅ 更新接口文档通知机制 | 字段改动必须审批发布 |
| ✅ 增加自动测试覆盖 | 提交表单逻辑新增集成测试 |
| ⬜ 建立问题标签系统 | 分类统计历史问题形成知识库 |

---

## 八、团队反馈与总结

- 开发 A：建议上线前建立 checklist
- 测试 B：希望接口字段统一由工具生成
- 产品 C：要求问题反馈响应在 15 分钟内

> ✅ 已组织 15 分钟复盘会议，形成改进共识。

---

## 九、后续待办事项

- [ ] 补全单元测试用例
- [ ] 更新线上监控规则
- [ ] 整理接口变更文档
- [ ] 建立“Hotfix 模板”供后续复用

---

## 十、领导同步

- 🧾 已向 XXX 主管/部门负责人同步事故情况
- 📈 汇报内容包含：问题描述、影响评估、修复方案、改进方向
